<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>{{ item.title }} | Lost & Found</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    :root{--bd:rgba(15,23,42,.10);}
    body{background: radial-gradient(circle at top left,#e9fff2 0%,#f4fff8 30%,#f7fbff 70%,#fff 100%); font-family:system-ui;}
    .wrap{max-width:980px; margin:0 auto; padding:28px 16px;}
    .cardx{border-radius:18px; border:1px solid var(--bd); background:rgba(255,255,255,.92); box-shadow:0 14px 30px rgba(15,23,42,.06);}
    .pill{border-radius:999px;}
    .tag{border-radius:999px; padding:.32rem .65rem; font-weight:800; font-size:.85rem; border:1px solid rgba(15,23,42,.12);}
  </style>
</head>
<body>
  <div class="wrap">

    <div class="cardx p-4 mb-3 d-flex justify-content-between align-items-center">
      <div>
        <div class="text-muted small">
          Posted by <b>{{ item.created_by.username }}</b> • {{ item.created_at|date:"M d, Y H:i" }}
        </div>
        <h3 class="fw-bold mb-1">{{ item.title }}</h3>
        <div class="text-muted">
          {{ item.get_item_type_display }}
          • {% if item.location %}{{ item.location }}{% else %}—{% endif %}
          • {{ item.get_status_display }}
          {% if item.date_happened %} • {{ item.date_happened|date:"M d, Y" }}{% endif %}
        </div>
      </div>
      <a class="btn btn-outline-dark pill" href="{% url 'lostfound:list' %}">Back</a>
    </div>

    {% if messages %}
      <div class="mb-3">
        {% for message in messages %}
          <div class="alert alert-{{ message.tags }} mb-2">{{ message }}</div>
        {% endfor %}
      </div>
    {% endif %}

    <div class="cardx p-4">
      {% if item.image %}
        <img src="{{ item.image.url }}" class="w-100 mb-3" style="border-radius:16px; max-height:420px; object-fit:cover;">
      {% endif %}

      {% if item.description %}
        <p class="mb-3">{{ item.description|linebreaksbr }}</p>
      {% else %}
        <p class="text-muted mb-3">No description provided.</p>
      {% endif %}

      <div class="d-flex gap-2 flex-wrap">
        {% if can_claim %}
          {% if already_claimed %}
            <span class="badge text-bg-secondary p-2">You already submitted a claim</span>
          {% else %}
            <a class="btn btn-success pill" href="{% url 'lostfound:claim' item.pk %}">Claim this item</a>
          {% endif %}
        {% endif %}
      </div>
    </div>

    {% if claims %}
      <div class="cardx p-4 mt-3">
        <h5 class="fw-bold mb-2">Claims (Staff view)</h5>
        {% for c in claims %}
          <div class="border-top pt-3 mt-3">
            <div class="fw-bold">
              {{ c.student.username }} • <span class="text-muted">{{ c.get_status_display }}</span>
            </div>
            <div class="text-muted small">{{ c.created_at|date:"M d, Y H:i" }}</div>
            <div class="mt-2">{{ c.proof_message|linebreaksbr }}</div>
          </div>
        {% empty %}
          <div class="text-muted">No claims yet.</div>
        {% endfor %}
      </div>
    {% endif %}

  </div>
</body>
</html>
