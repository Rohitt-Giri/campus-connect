<!doctype html>
<html>
<head>
  <title>Audit Logs</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="p-4">

<h3 class="fw-bold mb-3">Admin — Activity Logs</h3>

<form method="get" class="row g-2 mb-3">
  <div class="col-md-5">
    <input class="form-control" name="q" value="{{ q }}" placeholder="Search message / user / target">
  </div>
  <div class="col-md-4">
    <select class="form-select" name="action">
      <option value="">All Actions</option>
      {% for k,v in actions %}
        <option value="{{ k }}" {% if action == k %}selected{% endif %}>{{ v }}</option>
      {% endfor %}
    </select>
  </div>
  <div class="col-md-3">
    <button class="btn btn-dark w-100">Filter</button>
  </div>
</form>

<table class="table table-striped align-middle">
  <thead>
    <tr>
      <th>Time</th>
      <th>Actor</th>
      <th>Action</th>
      <th>Target</th>
      <th>Message</th>
      <th>IP</th>
    </tr>
  </thead>
  <tbody>
    {% for l in logs %}
      <tr>
        <td class="text-muted">{{ l.created_at|date:"M d, Y H:i" }}</td>
        <td class="fw-semibold">
          {% if l.actor %}{{ l.actor.username }}{% else %}—{% endif %}
        </td>
        <td>{{ l.get_action_display }}</td>
        <td>
          <div class="fw-semibold">{{ l.target_label|default:"—" }}</div>
          <div class="text-muted small">{{ l.target_model }} #{{ l.target_id }}</div>
        </td>
        <td>{{ l.message }}</td>
        <td class="text-muted">{{ l.ip_address|default:"" }}</td>
      </tr>
    {% empty %}
      <tr><td colspan="6" class="text-muted text-center py-4">No logs yet.</td></tr>
    {% endfor %}
  </tbody>
</table>

</body>
</html>